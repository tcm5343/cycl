[backend]
requires = ['setuptools>=64', 'setuptools-scm>=8']
build-backend = 'setuptools.build_meta'

[project]
name = 'cycl'
version='0.0.2'
description = 'CLI and Python SDK to help identify cross-stack import/export circular dependencies, for a given AWS account and region.'
readme = 'README.md'
keywords = ['aws', 'cdk', 'cycle', 'circular', 'dependency', 'infrastructure']
classifiers = [
    'Intended Audience :: Developers',
    'Natural Language :: English',
    'Programming Language :: Python :: 3',
    'Programming Language :: Python',
    'Topic :: Software Development',
]
dependencies = [
    'boto3~=1.0',
    'networkx~=3.0',
]

[project.optional-dependencies]
dev = [
    'pytest-cov==6.0.0',
    'pytest-subtests==0.14.1',
    'pytest-sugar==1.0.0',
    'pytest==8.3.4',
    'ruff==0.9.4',
]

[project.urls]
Repository = 'http://github.com/tcm5343/cycl'

[project.scripts]
cycl = 'cycl.cli:app'

[tool.ruff]
line-length = 125

[tool.ruff.lint]
# desire is to add COM812 too
select = ['ALL']
ignore = [
    'COM',  # flake8-commas
    'D',  # pydocstyle
    'ERA001',  # commented-out-code
    'FIX002',  # line-contains-todo
    'Q000',  # bad-quotes-inline-string
    'Q003',  # avoidable-escaped-quote
    'T201',  # print
    'TD',  # flake8-todos
]

[tool.ruff.lint.per-file-ignores]
'tests/**' = [
    'ANN',  # flake8-annotations
    'PLR2004',  # magic-value-comparison
    'S101',  # assert
]
'__init__.py' = [
    'F401',  # unused-import
]

[tool.ruff.format]
quote-style = 'single'
indent-style = 'space'
docstring-code-format = true

[tool.coverage.run]
branch = true
source = ['./src']

[tool.coverage.report]
fail_under = 90
show_missing = true
skip_covered = true
skip_empty = true
omit = [
    '__*__.py'
]

[tool.pytest.ini_options]
log_cli_level = "INFO"
addopts = ['--import-mode=importlib']

# [tool.tox]
# requires = ["tox>=4.19"]
# setenv = 'VIRTUALENV_DISCOVERY=pyenv'
# env_list = [
#     "3.8",
#     "3.9",
#     "3.10",
#     "3.11",
#     "3.12",
#     "3.13",
# ]

# [tool.tox.env_run_base]
# allowlist_externals = ['pytest']
# description = "Run test under {base_python}"
# commands = [["pytest", '--cov=./src/', './tests/']]
